Связи между таблицами:

1:1 — Один к одному
┌─────┐      ┌─────┐
│  1  │──────│  1  │
└─────┘      └─────┘
Пример: Посетитель — Паспортные данные

1:M — Один ко многим
┌─────┐      ┌─────┐
│  1  │──────│  M  │
└─────┘      └─────┘
Пример: Категория — Блюда (одна категория, много блюд)

M:M — Многие ко многим
┌─────┐      ┌─────┐
│  M  │──────│  M  │
└─────┘      └─────┘
Пример: Заказы — Блюда (требуется связующая таблица)


Соглашение об названиях аттрибутов
-- Таблицы: существительные во множественном числе
users, orders, menu_items


-- Поля: snake_case
first_name, created_at, is_active

-- Первичный ключ: id или <таблица>_id
id, user_id, order_id

-- Внешний ключ: <таблица>_id
user_id, category_id

--Булевые поля, начинаются с is
is_available 



Нормальные формы

Правила 1НФ:
Все атрибуты должны содержать атомарные (неделимые) значения
Нет повторяющихся групп данных
Каждая запись уникальна (есть первичный ключ)


Правила 2НФ:
Находится в 1НФ
Нет частичной зависимости от составного ключа
Все неключевые атрибуты должны зависеть от всего первичного ключа


Правила 3НФ:
Находится в 2НФ
Нет транзитивной зависимости
Неключевые атрибуты не должны зависеть от других неключевых атрибутов
Все неключевые атрибуты зависят ТОЛЬКО от первичного ключа


ER диаграмма для урока

┌─────────────┐      ┌─────────────┐      ┌─────────────┐
│  visitors   │      │ reservations│      │   waiters   │
├─────────────┤      ├─────────────┤      ├─────────────┤
│ id (PK)     │<────┐│ id (PK)     │      │ id (PK)     │
│ first_name  │     ││ visitor_id  │      │ first_name  │
│ last_name   │     ││ table_number│      │ last_name   │
│ phone       │     ││ res_time    │      │ hire_date   │
│ email       │     ││ guests_count│      │ hourly_rate │
│ loyalty_card│     ││ status      │      └─────────────┘
│ registered_at│     └─────────────┘              ↑
└─────────────┘                                   │
        ↑                                         │
        │                                    ┌────┴─────┐
┌───────┴───────┐      ┌─────────────┐      │  orders  │
│    orders     │      │ order_items │      ├──────────┤
├───────────────┤      ├─────────────┤      │ id (PK)  │
│ id (PK)       │<────┐│ order_id    │      │ visitor_id│
│ visitor_id    │     ││ dish_id     │      │ waiter_id │
│ waiter_id     │     ││ quantity    │      │ table_num │
│ table_number  │     ││ price_at_mom│      │ order_time│
│ order_time    │     ││ special_req │      │ status    │
│ status        │     └──────┬──────┘      │ total_amnt│
│ total_amount  │            │             └───────────┘
└───────────────┘            │                    ↑
        ↑                    │                    │
        │              ┌─────┴──────┐             │
┌───────┴───────┐      │   dishes   │      ┌──────┴───────┐
│  categories   │      ├────────────┤      │ dish_ingred  │
├───────────────┤      │ id (PK)    │      ├──────────────┤
│ id (PK)       │<────┐│ category_id│      │ dish_id      │
│ name          │     ││ name       │      │ ingredient_id│
│ description   │     ││ price      │      │ quantity_req │
│ display_order │     ││ is_avail   │      └──────┬───────┘
└───────────────┘     ││ prep_time  │             │
                      └────────────┘               │
                                              ┌─────┴─────┐
                                              │ingredients│
                                              ├───────────┤
                                              │ id (PK)   │
                                              │ name      │
                                              │ unit      │
                                              │ stock_qty │
                                              └───────────┘